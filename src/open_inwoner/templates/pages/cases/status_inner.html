{% load i18n ssd_tags anchor_menu_tags card_tags dashboard_tags file_tags grid_tags table_tags solo_tags link_tags button_tags icon_tags notification_tags %}

{# Messages #}
<div class="container container--no-margin" id="cases-status-messages-oob" hx-swap-oob="true">
    {% notifications messages %}
</div>

{% get_solo 'openzaak.OpenZaakConfig' as openzaak_config %}

<div class="cases__grid">
{% if case %}
    {% render_grid %}
        {% render_column span=12 %}
            {# Title/dashboard. #}
            <h1 class="h1" id="title">{{ case.description }}</h1>
            {% case_dashboard case %}
        {% endrender_column %}

        {% render_column start=4 span=6 %}
            {#  Status history. #}
            <section id="statuses_component" class="statuses__section">
                {% include 'pages/cases/statuses.html' %}
            </section>

            {#  Documents. #}
            {% if case.documents %}
                <h2 class="h2" id="documents">{% trans 'Documenten' %}</h2>
                {% case_document_list case.documents %}
            {% endif %}

            {% if case.internal_upload_enabled %}
                <h2 class="h2" id="documents-upload">{% trans "Document uploaden" %}</h2>

                {% notifications messages show_local_messages=True %}

                {% if case.case_type_document_upload_description %}
                <div class="card card--compact card--info">
                    <div class="card__body document-upload-description">
                        {% icon icon="info" icon_position="after" extra_classes="icon--info" outlined=True %}

                        <div class="document-upload-description__text">{{ case.case_type_document_upload_description|markdown|safe }}</div>
                    </div>
                </div>
                {% endif %}

                {% if case.case_type_config_description %}
                    <p class="p">{{ case.case_type_config_description }}</p>
                {% else %}
                    <p class="p">
                        {% blocktranslate with max_filesize=openzaak_config.max_upload_size allowed_extensions=case.allowed_file_extensions|join:', ' %}
                            Grootte max. {{ max_filesize }} MB, toegestane document formaten: {{ allowed_extensions }}.
                        {% endblocktranslate %}
                    </p>
                {% endif %}

                {#  Upload document form. #}
                <section id="form_upload" class="form__open-upload">
                    {% include 'pages/cases/document_form.html' %}
                </section>

            {% elif case.external_upload_enabled %}
                <h2 class="h2" id="documents-upload">{% trans "Document toevoegen" %}</h2>
                {% if case.case_type_config_description %}
                    <p class="p">{{ case.case_type_config_description }}</p>
                {% else %}
                    <p class="p">{% trans "By clicking the button below you can upload a document. This is an external link and you will be redirected to a different system." %}</p>
                {% endif %}
                {% button_row %}
                    {% button href=case.external_upload_url text=_("Document uploaden") title=_("Opens new window") primary=True icon="open_in_new" icon_position="after" %}
                {% endbutton_row %}
            {% endif %}

            {#  Contact moment form #}
            {% if case.contact_form_enabled %}
                <section id="cases-contact-form" class="form_contact">
                    <div id="cases-contact-form-content">
                        {% include 'pages/cases/contact_form.html' %}
                    </div>
                </section>
            {% endif %}

        {% endrender_column %}
    {% endrender_grid %}
{% else %}
    <h2 class="h2">{% trans 'There is no available data at the moment.' %}</h2>
{% endif %}
</div>
